schema: '2.0'
stages:
  slide_download:
    cmd: python ../utils/file_transfer.py --out_csv .downloaded_slides.csv --data_path
      /data/anapath/AprioricsSlides --ihc_type P40ColIV --mapping_file ../../ihc_mapping.json
      --mask_extension .tif --remote_path /media/AprioricsSlides --slide_extension
      .svs --clean_previous --import_ihc --add_tree --import_file .P40ColIV --extension
      .svs --rel_path slides --remote_rel_path .
    outs:
    - path: .downloaded_slides.csv
      md5: 45c29e07f7391f89ca9662a6332a4969
      size: 530
  mask_extraction:
    cmd: python register_extract_polygons_masks_mp.py --data_path /data/anapath/AprioricsSlides
      --ihc_type P40ColIV --mapping_file ../../ihc_mapping.json --mask_extension .tif
      --remote_path /media/AprioricsSlides --slide_extension .svs --dab_thr 0.015
      --object_min-size 50 --binary_op none --num_workers 20 --iou_thr 0.05 --nuc_max_siz
      40 --mask_path masks --main_slide_path slides --slide_path slides_tmp --geojson_path
      geojsons --log_path registration_geojsons --hovernet_path hovernet_geojsons
    deps:
    - path: .downloaded_slides.csv
      md5: 45c29e07f7391f89ca9662a6332a4969
      size: 530
    outs:
    - path: /data/anapath/AprioricsSlides/geojsons/P40ColIV
      md5: 08f3fd60cfe66101556a2ccc6432e0f1.dir
      size: 38923464
      nfiles: 3
    - path: /data/anapath/AprioricsSlides/masks/P40ColIV
      md5: 121c49181954513e17a805137ddd9b37.dir
      size: 1735937153
      nfiles: 3
    - path: /data/anapath/AprioricsSlides/registration_geojsons/P40ColIV
      md5: e70185580cd8e6edb62e88edaae5e1b2.dir
      size: 24859
      nfiles: 3
